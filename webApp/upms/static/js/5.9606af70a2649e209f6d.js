webpackJsonp([5],{IpKx:function(e,t){},LEaK:function(e,t){},"iL+G":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("GtFF"),r=s("gyMJ"),o={name:"Divisions",props:["divisionValue"],data:function(){return{props:{checkStrictly:!0,emitPath:!0,lazy:!0,lazyLoad:function(e,t){var s=null;s=e.root?{pcode:"86"}:{pcode:e.value},Object(r.queryDivisions)(s).then(function(s){var a=[];0===s.data.code&&s.data.data.forEach(function(t){var s={};s.value=t.areaCode,s.label=t.areaName,s.leaf=e.level>=3,a.push(s)}),t(a)})}},value:[]}},components:{queryDivisions:r.queryDivisions},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},watch:{},computed:{},directives:{},filter:{},methods:{emitToParent:function(){this.$emit("sendDivisions",this.divisionValue)}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-cascader",{attrs:{props:e.props,clearable:""},on:{change:e.emitToParent},model:{value:e.divisionValue,callback:function(t){e.divisionValue=t},expression:"divisionValue"}})],1)},staticRenderFns:[]};var l=s("VU/8")(o,i,!1,function(e){s("IpKx")},"data-v-43c8cb70",null).exports,n={name:"User",data:function(){var e=this;return{showQuery:!0,divisionValue:[],roleValue:[],options:[],centerDialogVisible:!1,addOrModifyMark:!1,userObj:{},roleProp:{multiple:!0,expandTrigger:"hover",value:"id",label:"name",children:"roleList"},rules:{userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],realName:[{required:!0,message:"真实姓名不能为空",trigger:"blur"}],salt:[{required:!0,message:"盐不能为空",trigger:"blur"}],status:[{required:!0,message:"账号状态不能为空",trigger:"blur"}]},tableOptions:{api:r.queryUserList,query:{userName:""},hideOnSinglePage:!1,staticData:[],columns:[{attr:{prop:"checkbox",type:"selection",label:"多选",width:"80"}},{attr:{type:"index",label:"序号",width:"80"}},{attr:{prop:"userName",label:"用户名"}},{attr:{prop:"realName",label:"姓名"}},{attr:{prop:"salt",label:"盐","show-overflow-tooltip":!0}},{attr:{prop:"sex",label:"性别",formatter:function(e,t,s,a){var r="男";return"1"===s&&(r="女"),r}}},{attr:{prop:"phone",label:"电话"}},{attr:{prop:"email",label:"邮箱"}},{attr:{prop:"userType",label:"用户类型",formatter:function(e,t,s,a){return"内部人员"}}},{attr:{prop:"status",label:"状态",formatter:function(e,t,s,a){var r="初始化";return"1"===s?r="正常":"2"===s?r="停用":"3"===s&&(r="锁定"),r}}},{attr:{prop:"operation",label:"操作",width:100,fixed:"right"},template:[{el:"el-button",attr:{type:"text"},content:"修改",attrByRow:{},handle:function(t,s){e.modifyUser(s)}},{el:"el-button",attr:{type:"text"},content:"删除",attrByRow:{},handle:function(t,s){e.removeUser(s)}}]}]}}},props:{},components:{TableBase:a.a,Divisions:l},beforeCreate:function(){},created:function(){this.selectRole()},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},watch:{},computed:{},directives:{},filter:{},methods:{getDivisions:function(e){this.divisionValue=e},loadData:function(){this.$refs.table.refresh()},clear:function(){this.tableOptions.query={userName:""}},toggleQuery:function(){this.showQuery=!this.showQuery},refresh:function(){this.$refs.table.refresh()},selectRole:function(){var e=this;Object(r.queryRoleTree)({}).then(function(t){0===t.data.code&&(e.options=t.data.data)})},addUser:function(){this.centerDialogVisible=!0,this.addOrModifyMark=!0,this.userObj={userName:"",realName:"",phone:"",email:"",sex:"0",areaCode:"",sysRoleIds:[],status:"0",salt:this.$common.getUUID().replace(/-/g,""),userType:"0",delFlag:"0"},this.divisionValue=[],this.roleValue=[]},saveUserObj:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;var s=e.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a="";a=e.addOrModifyMark?"user/add":"user/modify";var o="";e.divisionValue.forEach(function(t,s){s!==e.divisionValue.length-1?o+=t+"_":o+=t}),e.userObj.areaCode=o;var i=[];e.roleValue.forEach(function(e){i.push(e[0]+"_"+e[1])}),e.userObj.sysRoleIds=i,Object(r.addOrModifyUser)(a,e.userObj).then(function(t){s.close(),0===t.data.code?(e.$message({showClose:!0,message:"保存成功！",type:"success"}),e.centerDialogVisible=!1,e.loadData()):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(t){s.close(),e.centerDialogVisible=!1,e.$message({showClose:!0,message:"保存失败！",type:"error"})})})},modifyUser:function(e){var t=this;if("click"===e.type){if(1!==this.$refs.table.getSelectData().length)return void this.$message({showClose:!0,message:"请选择一条数据修改！",type:"warning"});e=this.$refs.table.getSelectData()[0]}Object(r.queryUser)({id:e.id}).then(function(e){if(0===e.data.code){t.userObj=e.data.data,t.divisionValue=e.data.data.areaCode.split("_");var s=[];e.data.data.sysRoleIds.forEach(function(e){var t=[];t.push(e.split("_")[0]),t.push(e.split("_")[1]),s.push(t)}),t.roleValue=s}else t.$message({showClose:!0,message:e.data.message,type:"error"})}),this.centerDialogVisible=!0,this.addOrModifyMark=!1},removeUser:function(e){var t=this,s=[];if("click"===e.type){if(this.$refs.table.getSelectData().length<1)return void this.$message({showClose:!0,message:"请至少选择一条数据删除！",type:"warning"});s=this.$refs.table.getSelectData()}else s.push(e);this.$confirm("确认是否删除角色，此操作无法撤销?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={listUserPo:[]};s.forEach(function(t){var s={id:t.id,version:t.version};e.listUserPo.push(s)}),Object(r.delUserList)(e).then(function(e){0===e.data.code?(t.$message({showClose:!0,message:"删除成功！",type:"success"}),t.$refs.table.refresh()):t.$message({showClose:!0,message:e.data.message,type:"error"})}).catch(function(e){t.$message({showClose:!0,message:"删除失败！",type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},initPwd:function(e){var t=this,s=[];if("click"===e.type){if(this.$refs.table.getSelectData().length<1)return void this.$message({showClose:!0,message:"请至少选择一条数据！",type:"warning"});s=this.$refs.table.getSelectData()}else s.push(e);this.$confirm("确认是否初始化密码，此操作无法撤销?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={listUserPo:[]};s.forEach(function(t){var s={id:t.id,version:t.version,salt:t.salt};e.listUserPo.push(s)}),Object(r.initPwd)(e).then(function(e){0===e.data.code?(t.$message({showClose:!0,message:"初始化密码成功！",type:"success"}),t.$refs.table.refresh()):t.$message({showClose:!0,message:e.data.message,type:"error"})}).catch(function(e){t.$message({showClose:!0,message:"初始化密码失败！",type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"app-container-item"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQuery,expression:"showQuery"}],staticClass:"app-form"},[s("div",{staticClass:"app-form-item"},[s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入用户名搜索",type:"text"},model:{value:e.tableOptions.query.userName,callback:function(t){e.$set(e.tableOptions.query,"userName",t)},expression:"tableOptions.query.userName"}})],1),e._v(" "),s("div",{staticClass:"app-form-buttons"},[s("div",{staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"primary"},on:{click:e.loadData}},[s("ant-icon",{attrs:{"icon-class":"SearchOutlined"}}),e._v("\n                查询\n              ")],1)],1),e._v(" "),s("div",{staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"success"},on:{click:e.clear}},[s("ant-icon",{attrs:{"icon-class":"RedoOutlined"}}),e._v("\n                重置\n              ")],1)],1)])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQuery,expression:"showQuery"}],staticClass:"app-hr"}),e._v(" "),s("div",{staticClass:"app-form"},[s("div",{staticClass:"app-form-buttons"},[s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:User:add",expression:"'upms:User:add'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[s("ant-icon",{attrs:{"icon-class":"PlusOutlined"}}),e._v("\n                新增\n              ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:User:upd",expression:"'upms:User:upd'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"success"},on:{click:e.modifyUser}},[s("ant-icon",{attrs:{"icon-class":"EditOutlined"}}),e._v("\n                修改\n              ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:User:del",expression:"'upms:User:del'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"danger"},on:{click:e.removeUser}},[s("ant-icon",{attrs:{"icon-class":"DeleteOutlined"}}),e._v("\n                删除\n              ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:User:initPwd",expression:"'upms:User:initPwd'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"warning"},on:{click:e.initPwd}},[s("ant-icon",{attrs:{"icon-class":"UploadOutlined"}}),e._v("\n                初始密码\n              ")],1)],1)]),e._v(" "),s("el-button-group",{staticClass:"app-form-button-group align-right"},[s("el-button",{attrs:{plain:"",type:"info",icon:"el-icon-search"},on:{click:e.toggleQuery}}),e._v(" "),s("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}})],1)],1)]),e._v(" "),s("div",{staticClass:"app-container-item"},[s("TableBase",e._b({ref:"table"},"TableBase",e.tableOptions,!1))],1),e._v(" "),s("el-dialog",{attrs:{title:"用户编辑",visible:e.centerDialogVisible,width:"480px"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.userObj,rules:e.rules,"label-suffix":"","label-width":"101px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[s("el-input",{attrs:{placeholder:"用户名",disabled:!e.addOrModifyMark},model:{value:e.userObj.userName,callback:function(t){e.$set(e.userObj,"userName",t)},expression:"userObj.userName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[s("el-input",{attrs:{placeholder:"姓名"},model:{value:e.userObj.realName,callback:function(t){e.$set(e.userObj,"realName",t)},expression:"userObj.realName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"盐",prop:"salt"}},[s("el-input",{attrs:{placeholder:"盐",disabled:!e.addOrModifyMark},model:{value:e.userObj.salt,callback:function(t){e.$set(e.userObj,"salt",t)},expression:"userObj.salt"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"性别",prop:"sex"}},[s("el-radio",{attrs:{label:"0"},model:{value:e.userObj.sex,callback:function(t){e.$set(e.userObj,"sex",t)},expression:"userObj.sex"}},[e._v("男")]),e._v(" "),s("el-radio",{attrs:{label:"1"},model:{value:e.userObj.sex,callback:function(t){e.$set(e.userObj,"sex",t)},expression:"userObj.sex"}},[e._v("女")])],1),e._v(" "),s("el-form-item",{attrs:{label:"电话",prop:"phone"}},[s("el-input",{attrs:{placeholder:"电话"},model:{value:e.userObj.phone,callback:function(t){e.$set(e.userObj,"phone",t)},expression:"userObj.phone"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{placeholder:"邮箱"},model:{value:e.userObj.email,callback:function(t){e.$set(e.userObj,"email",t)},expression:"userObj.email"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"地区",prop:"areaCode"}},[s("Divisions",{attrs:{divisionValue:e.divisionValue},on:{sendDivisions:e.getDivisions}})],1),e._v(" "),s("el-form-item",{attrs:{label:"角色",prop:"sysRoleIds"}},[s("el-cascader",{attrs:{props:e.roleProp,options:e.options,filterable:""},model:{value:e.roleValue,callback:function(t){e.roleValue=t},expression:"roleValue"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"账户状态",prop:"status"}},[s("el-radio",{attrs:{label:"0"},model:{value:e.userObj.status,callback:function(t){e.$set(e.userObj,"status",t)},expression:"userObj.status"}},[e._v("初始化")]),e._v(" "),s("el-radio",{attrs:{label:"1"},model:{value:e.userObj.status,callback:function(t){e.$set(e.userObj,"status",t)},expression:"userObj.status"}},[e._v("正常")]),e._v(" "),s("el-radio",{attrs:{label:"2"},model:{value:e.userObj.status,callback:function(t){e.$set(e.userObj,"status",t)},expression:"userObj.status"}},[e._v("停用")]),e._v(" "),s("el-radio",{attrs:{label:"3"},model:{value:e.userObj.status,callback:function(t){e.$set(e.userObj,"status",t)},expression:"userObj.status"}},[e._v("锁定")])],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.saveUserObj}},[e._v("确 定")])],1)],1),e._v(" "),s("router-view")],1)},staticRenderFns:[]};var c=s("VU/8")(n,u,!1,function(e){s("LEaK")},"data-v-7ec12fc5",null);t.default=c.exports}});
//# sourceMappingURL=5.9606af70a2649e209f6d.js.map