webpackJsonp([13],{CSbv:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),o=s("GtFF"),n=s("gyMJ"),l={name:"upload",props:["fileArray","isDisabled","ismultiple"],data:function(){return{fileheader:{Authorization:sessionStorage.token},dialogVisible:!1,dialogImageUrl:"",fileList:[],disabled:!1,multiple:!1}},watch:{fileArray:function(e){var t=this;this.fileList=[],null!=e&&void 0!==e&&e.forEach(function(e){var s=e.url.split(".");e.path=e.url,"png"===s[1].toLocaleLowerCase()||"jpg"===s[1].toLocaleLowerCase()||"jpeg"===s[1].toLocaleLowerCase()||"gif"===s[1].toLocaleLowerCase()||"bmp"===s[1].toLocaleLowerCase()?Object(n.base64Pic)({fileName:e.url}).then(function(s){e.url=s.data,t.fileList.push(t.$common.deepClone(e))}).catch(function(e){}):t.fileList.push(t.$common.deepClone(e))})},isDisabled:function(e){this.multiple=null!=e&&void 0!==e&&e},ismultiple:function(e){this.disabled=null!=e&&void 0!==e&&e}},created:function(){null!=this.isDisabled&&void 0!==this.isDisabled?this.disabled=this.isDisabled:this.disabled=!1,null!=this.ismultiple&&void 0!==this.ismultiple?this.multiple=this.ismultiple:this.multiple=!1},methods:{handlePictureCardPreview:function(e){var t=this,s=e.name.split(".");"png"===s[1].toLocaleLowerCase()||"jpg"===s[1].toLocaleLowerCase()||"jpeg"===s[1].toLocaleLowerCase()||"gif"===s[1].toLocaleLowerCase()||"bmp"===s[1].toLocaleLowerCase()?(this.dialogImageUrl=e.url,this.dialogVisible=!0):Object(n.downloadFile)({fileName:e.url}).then(function(s){t.$common.download(s.data,e.name)}).catch(function(e){t.$message({showClose:!0,message:"下载失败！",type:"error"})})},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},onChange:function(e,t){this.fileList=t,this.$emit("child-event",this.fileList)},onRemove:function(e,t){this.fileList=t,this.$emit("child-event",this.fileList)},onSuccess:function(e,t,s){if("004"===e.result)return this.$message({showClose:!0,message:"用户登录超时！",type:"error"}),void this.$router.push({name:"home",params:{}});for(var a in s)if(null!=s[a].response&&void 0!==s[a].response){s[a].path=s[a].response[0].newfilename;var i=s[a].path.split(".");"png"===i[1].toLocaleLowerCase()||"jpg"===i[1].toLocaleLowerCase()||"jpeg"===i[1].toLocaleLowerCase()||"gif"===i[1].toLocaleLowerCase()||"bmp"===i[1].toLocaleLowerCase()?Object(n.base64Pic)({fileName:s[a].path}).then(function(e){s[a].url=e.data}).catch(function(e){}):s[a].url=s[a].response[0].newfilename,s[a].response=null}this.fileList=s},onError:function(e,t,s){}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-upload",{staticClass:"upload-demo",attrs:{disabled:e.disabled,action:"../api/upms/file/uploadFile","on-preview":e.handlePictureCardPreview,"before-remove":e.beforeRemove,"on-change":e.onChange,"on-success":e.onSuccess,"on-error":e.onError,"on-remove":e.onRemove,"file-list":e.fileList,"list-type":"picture",multiple:e.multiple,headers:e.fileheader}},[e.disabled?e._e():s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible,center:"","append-to-body":"",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:e.dialogImageUrl,alt:""},on:{click:function(t){e.dialogVisible=!1}}})])],1)},staticRenderFns:[]},c=s("VU/8")(l,r,!1,null,null,null).exports,u={components:{TableBase:o.a,upload:c},name:"System",data:function(){var e=this;return{showQuery:!0,statusTypes:[{value:"0",label:"正常"},{value:"1",label:"禁用"},{value:"2",label:"系统禁用"}],fileArray:[],rules:{name:[{required:!0,message:"系统名称不能为空",trigger:"blur"}],orders:[{required:!0,message:"排序不能为空",trigger:"blur"}],title:[{required:!0,message:"系统标题不能为空",trigger:"blur"}],basepath:[{required:!0,message:"系统根目录不能为空",trigger:"blur"}]},objStatus:!1,systemObj:{},centerDialogVisible:!1,tableOptions:{api:n.querySystem,hideOnSinglePage:!1,staticData:[],query:{name:""},columns:[{attr:{prop:"id",type:"selection",label:"多选",width:"80"}},{attr:{type:"index",label:"序号",width:"80"}},{attr:{prop:"name",label:"系统名称","min-width":"140"}},{attr:{prop:"title",label:"系统标题","min-width":"140"}},{attr:{prop:"basepath",label:"根目录"}},{attr:{prop:"status",label:"状态",width:"180",formatter:function(e,t,s,a){var i="正常";return"1"===s&&(i="禁用"),i}}},{attr:{prop:"operation",label:"操作",width:100,fixed:"right"},template:[{el:"el-button",attr:{type:"text"},attrByRow:{disabled:function(e,t){if("2016-05-04"===t.date)return!0}},content:"修改",handle:function(t,s){e.editSystemRadio(s)}},{el:"el-button",attr:{type:"text"},content:"删除",handle:function(t,s){e.delBeforeRadio(s)}}]}]}}},props:{},beforeRouteEnter:function(e,t,s){s(function(e){e.loadData()})},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},watch:{},computed:{},directives:{},filter:{},methods:{toggleQuery:function(){this.showQuery=!this.showQuery},refresh:function(){this.$refs.tableref.refresh()},clear:function(){this.tableOptions.query={}},setFile:function(e){var t=[];if(null!=e&&e.length>0)for(var s in e){var a={};a.url=e[s].path,a.name=e[s].name,t.push(a)}this.systemObj.icon=i()(t)},openSystemButton:function(){var e=this,t=this.$refs.tableref.getSelectData();if(0!==t.length){for(var s=0;s<t.length;s++)if("0"===t[s].status)return void this.$message({showClose:!0,message:"系统名称为 "+t[s].name+" 正常，请不要重复启用！",type:"warning"});this.$confirm("此操作将启用选择系统, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.systemOpenOrClose)({status:"0",listSystemPo:t}).then(function(t){0===t.data.code?(e.$message({showClose:!0,message:"启用成功",type:"success"}),e.loadData()):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(e){})})}else this.$message({showClose:!0,message:"请选择要启用的系统！",type:"warning"})},closeSystemButton:function(){var e=this,t=this.$refs.tableref.getSelectData();if(0!==t.length){for(var s=0;s<t.length;s++)if("0"!==t[s].status)return void this.$message({showClose:!0,message:"系统名称为 "+t[s].name+" 已禁用，请不要重复禁用！",type:"warning"});this.$confirm("此操作将禁用选择权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.systemOpenOrClose)({status:"1",listSystemPo:t}).then(function(t){0===t.data.code?(e.$message({showClose:!0,message:"禁用成功",type:"success"}),e.loadData()):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(e){})})}else this.$message({showClose:!0,message:"请选择要禁用的记录！",type:"warning"})},loadData:function(){this.$refs.tableref.refresh()},addSystem:function(){this.systemObj={status:"0",orders:1},this.objStatus=!1,this.fileArray=[],this.centerDialogVisible=!0},editSystemRadio:function(e){this.objStatus=!0,this.systemObj=e,this.fileArray=[],null!=this.systemObj.icon&&void 0!==this.systemObj.icon&&""!==this.systemObj.icon&&(this.fileArray=JSON.parse(this.systemObj.icon)),this.centerDialogVisible=!0},editSystem:function(){var e=this.$refs.tableref.getSelectData();if(0!==e.length)if(e.length>1)this.$message({showClose:!0,message:"修改只可选择一条记录！",type:"warning"});else{for(var t=0;t<e.length;t++)if("0"!==e[t].status)return void this.$message({showClose:!0,message:"请先启用"+e[t].name+"，再修改！",type:"warning"});this.objStatus=!0,this.systemObj=e[0],this.fileArray=[],null!=this.systemObj.icon&&void 0!==this.systemObj.icon&&""!==this.systemObj.icon&&(this.fileArray=JSON.parse(this.systemObj.icon)),this.centerDialogVisible=!0}else this.$message({showClose:!0,message:"请选择要修改的记录！",type:"warning"})},delBeforeRadio:function(e){var t=this;this.$confirm("此操作将永久删除选择记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=[];s.push(e),t.deleteSystem(s)})},delBeforeSystemButton:function(){var e=this,t=this.$refs.tableref.getSelectData();0!==t.length?this.$confirm("此操作将永久删除选择记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteSystem(t)}):this.$message({showClose:!0,message:"请选择要修改的记录！",type:"warning"})},deleteSystem:function(e){var t=this;Object(n.delSystem)({listSystemPo:e}).then(function(e){0===e.data.code?(t.$message({showClose:!0,message:"删除成功！",type:"success"}),t.centerDialogVisible=!1,t.loadData()):t.$message({showClose:!0,message:e.data.message,type:"error"})}).catch(function(e){console.log(e),t.$message({showClose:!0,message:"删除失败！",type:"error"})})},expSystem:function(){},saveSystemObj:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;var s=e.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.objStatus?Object(n.editSystem)(e.systemObj).then(function(t){s.close(),0===t.data.code?(e.$message({showClose:!0,message:"保存成功！",type:"success"}),e.centerDialogVisible=!1,e.loadData()):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(t){console.log(t),s.close(),e.$message({showClose:!0,message:"保存失败！",type:"error"})}):Object(n.addSystem)(e.systemObj).then(function(t){s.close(),0===t.data.code?(e.$message({showClose:!0,message:"保存成功！",type:"success"}),e.centerDialogVisible=!1,e.loadData()):e.$message({showClose:!0,message:t.data.message,type:"error"})}).catch(function(t){console.log(t),s.close(),e.$message({showClose:!0,message:"保存失败！",type:"error"})})})}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"app-container-item"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQuery,expression:"showQuery"}],staticClass:"app-form"},[s("div",{staticClass:"app-form-item"},[s("el-input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"输入系统名称搜索"},model:{value:e.tableOptions.query.name,callback:function(t){e.$set(e.tableOptions.query,"name",t)},expression:"tableOptions.query.name"}})],1),e._v(" "),s("div",{staticClass:"app-form-item"},[s("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.tableOptions.query.status,callback:function(t){e.$set(e.tableOptions.query,"status",t)},expression:"tableOptions.query.status"}},e._l(e.statusTypes,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("div",{staticClass:"app-form-buttons"},[s("div",{staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"primary"},on:{click:e.loadData}},[s("ant-icon",{attrs:{"icon-class":"SearchOutlined"}}),e._v("\n            查询\n          ")],1)],1),e._v(" "),s("div",{staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"success"},on:{click:e.clear}},[s("ant-icon",{attrs:{"icon-class":"RedoOutlined"}}),e._v("\n            重置\n          ")],1)],1)])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQuery,expression:"showQuery"}],staticClass:"app-hr"}),e._v(" "),s("div",{staticClass:"app-form"},[s("div",{staticClass:"app-form-buttons"},[s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:System:add",expression:"'upms:System:add'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"success"},on:{click:e.addSystem}},[s("ant-icon",{attrs:{"icon-class":"PlusOutlined"}}),e._v("\n            新增\n          ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:System:upd",expression:"'upms:System:upd'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"danger"},on:{click:e.editSystem}},[s("ant-icon",{attrs:{"icon-class":"EditOutlined"}}),e._v("\n            修改\n          ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:System:del",expression:"'upms:System:del'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"warning"},on:{click:e.delBeforeSystemButton}},[s("ant-icon",{attrs:{"icon-class":"DeleteOutlined"}}),e._v("\n            删除\n          ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:System:enable",expression:"'upms:System:enable'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"warning"},on:{click:e.openSystemButton}},[s("ant-icon",{attrs:{"icon-class":"UploadOutlined"}}),e._v("\n            启用\n          ")],1)],1),e._v(" "),s("div",{directives:[{name:"buttonshow",rawName:"v-buttonshow",value:"upms:System:unable",expression:"'upms:System:unable'"}],staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"warning"},on:{click:e.closeSystemButton}},[s("ant-icon",{attrs:{"icon-class":"UploadOutlined"}}),e._v("\n            禁用\n          ")],1)],1),e._v(" "),s("div",{staticClass:"app-form-buttons-item"},[s("el-button",{attrs:{type:"warning"},on:{click:e.expSystem}},[s("ant-icon",{attrs:{"icon-class":"UploadOutlined"}}),e._v("\n            导出\n          ")],1)],1)]),e._v(" "),s("el-button-group",{staticClass:"app-form-button-group align-right"},[s("el-button",{attrs:{plain:"",type:"info",icon:"el-icon-search"},on:{click:e.toggleQuery}}),e._v(" "),s("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}})],1)],1)]),e._v(" "),s("div",{staticClass:"app-container-item"},[s("TableBase",e._b({ref:"tableref"},"TableBase",e.tableOptions,!1))],1),e._v(" "),s("el-dialog",{attrs:{title:"系统编辑",visible:e.centerDialogVisible,width:"480px"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.systemObj,rules:e.rules,"label-suffix":"","label-width":"120px"}},[s("el-form-item",{attrs:{label:"系统标题",prop:"title"}},[s("el-input",{attrs:{placeholder:"系统标题"},model:{value:e.systemObj.title,callback:function(t){e.$set(e.systemObj,"title",t)},expression:"systemObj.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"系统名称",prop:"name"}},[s("el-input",{attrs:{placeholder:"系统名称"},model:{value:e.systemObj.name,callback:function(t){e.$set(e.systemObj,"name",t)},expression:"systemObj.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"根目录",prop:"basepath"}},[s("el-input",{attrs:{placeholder:"根目录"},model:{value:e.systemObj.basepath,callback:function(t){e.$set(e.systemObj,"basepath",t)},expression:"systemObj.basepath"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"图标",prop:"icon"}},[s("upload",{attrs:{fileArray:e.fileArray},on:{"child-event":e.setFile}})],1),e._v(" "),s("el-form-item",{attrs:{label:"系统描述",prop:"description"}},[s("el-input",{attrs:{type:"textarea",rows:3,placeholder:"系统描述"},model:{value:e.systemObj.description,callback:function(t){e.$set(e.systemObj,"description",t)},expression:"systemObj.description"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"排序",prop:"orders"}},[s("el-input-number",{attrs:{min:1},model:{value:e.systemObj.orders,callback:function(t){e.$set(e.systemObj,"orders",t)},expression:"systemObj.orders"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"系统主题",prop:"theme"}},[s("el-input",{attrs:{placeholder:"系统主题"},model:{value:e.systemObj.theme,callback:function(t){e.$set(e.systemObj,"theme",t)},expression:"systemObj.theme"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.saveSystemObj}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=s("VU/8")(u,m,!1,function(e){s("Z+Lr")},"data-v-2935567a",null);t.default=p.exports},"Z+Lr":function(e,t){}});
//# sourceMappingURL=13.de6fb9ca04db65d8934f.js.map